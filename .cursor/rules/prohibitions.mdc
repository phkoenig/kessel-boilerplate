---
description: Nicht verhandelbare, projektweite Verbote. Diese Regeln haben immer Vorrang und gelten bei JEDER Interaktion.
alwaysApply: true
---

# STRIKTE VERBOTE

Du bist ein KI-Assistent, der strikten, nicht verhandelbaren Regeln unterliegt. Ein Verstoß gegen diese Regeln ist ein kritischer Fehler.

## SICHERHEIT UND DATEN

- **VERBOTEN:** Schreibe NIEMALS API-Schlüssel, Passwörter, Secrets oder sensible Daten (auch keine Beispieldaten) in den Code oder in Chat-Antworten.
- **VERBOTEN:** Verwende NIEMALS unsichere Protokolle (z.B. `http://` für APIs). Erzwinge `https://`.
- **VERBOTEN:** Deaktiviere NIEMALS SSL/TLS-Validierungen oder Sicherheitsfunktionen.

## TYPESCRIPT UND CODE-QUALITÄT

- **VERBOTEN:** Verwende NIEMALS den Typ `any`. Finde den korrekten Typ, definiere ein `interface`, oder verwende `unknown`, wenn der Typ wirklich unbekannt ist und validiert werden muss.
- **VERBOTEN:** Verwende NIEMALS `ts-ignore` oder `ts-expect-error` ohne einen nachfolgenden Kommentar, der das "Warum" (z.B. ein Link zu einem Library-Bug) präzise erklärt.
- **VERBOTEN:** Führe NIEMALS "Zombie-Code" (auskommentierten Code) in neuen Code-Blöcken ein. Code wird über Git verwaltet, nicht im Quelltext auskommentiert.
- **VERBOTEN:** Verwende NIEMALS Default-Exporte (`export default`). Verwende ausschließlich benannte Exporte (`export const...`, `export interface...`).
- **VERBOTEN:** Keine `console.log` im finalen Code. Verwende stattdessen einen Logger oder entferne Debug-Ausgaben vor dem Commit.

## PROJEKT-SPEZIFIKA

- **VERBOTEN:** Importiere NIEMALS aus veralteten Modulen (z.B. `@supabase/auth-helpers`, `tailwindcss-animate`). Verwende stattdessen `@supabase/ssr` und `tw-animate-css`.
- **VERBOTEN:** Führe NIEMALS `npm` oder `yarn` Befehle aus. Dieses Projekt verwendet ausschließlich `pnpm`.
- **VERBOTEN:** Committe NIEMALS ohne explizite Aufforderung des Users. Code-Änderungen sind Vorschläge, keine automatischen Commits.
- **VERBOTEN:** Keine globalen Singletons für Supabase/Clients außerhalb der vorgesehenen Utils (`src/utils/supabase/`).

## SUPABASE-SPEZIFIKA

- **VERBOTEN:** Verwende NIEMALS `SERVICE_ROLE_KEY` im Client-Code. Nur serverseitig (API-Routes, Scripts).
- **VERBOTEN:** Erstelle NIEMALS Vault-Funktionen ohne anschließende REVOKE-Statements.
- **VERBOTEN:** Deaktiviere NIEMALS Row Level Security (RLS) komplett.
- **VERBOTEN:** Speichere NIEMALS Secrets außerhalb des Supabase Vault (kein Doppler, kein .env commit).

## UMGEBUNGSVARIABLEN & SECRETS

- **VERBOTEN:** Verwende NIEMALS Fallback-Defaults für Secrets im Code (`|| "default-value"`).
- **VERBOTEN:** Erstelle NIEMALS neue Umgebungsvariablen ohne sie ZUERST im Supabase Vault zu speichern.
- **VERBOTEN:** Schreibe NIEMALS Secrets manuell in `.env.local` - immer via Vault + `pnpm pull-env`!
- **PFLICHT:** Bei neuen Umgebungsvariablen diesen Workflow befolgen:
  1. Secret im Vault erstellen (siehe `.cursor/rules/secrets.mdc` für Copy-Paste-Befehle)
  2. `pnpm pull-env` ausführen
  3. In `src/env.mjs` registrieren (Zod-Schema)
  4. Dev-Server neustarten

## PFLICHT-DOKUMENTATION

Bei folgenden Stichworten MUSS ZUERST die Dokumentation gelesen werden, BEVOR irgendwelche Aktionen durchgeführt werden:

### Secrets, Vault, API-Keys, Credentials, Environment Variables, .env.local

- **PFLICHT:** `.cursor/rules/secrets.mdc` - Copy-Paste-Ready Befehle für Vault-Operationen
- **PFLICHT:** `docs/guides/secrets-management.md` - Vollständige Secrets-Architektur

**KESSEL Vault** (Project Ref: `ufqlocxqizmiaozkashi`):
- ALLE Secrets zentral gespeichert
- `pnpm pull-env` lädt Secrets aus Vault in `.env.local`

**Bei fehlendem Secret:**
1. **NICHT** manuell in `.env.local` hinzufügen!
2. Secret im Vault erstellen (Befehle in `secrets.mdc`)
3. `pnpm pull-env` ausführen
